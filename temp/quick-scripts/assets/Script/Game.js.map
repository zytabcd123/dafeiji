{"version":3,"sources":["Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["import Bullet from \"./Bullet\";\nimport BulletGroup from \"./BulletGroup\";\n\n// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\nenum GameState {\n    non,\n    start,\n    pause,\n    over //结束\n}\n\n@ccclass\nexport default class Game extends cc.Component {\n    \n    @property(BulletGroup) bubbleGroup: BulletGroup = null\n    @property(cc.Label) scoreLabel: cc.Label = null\n\n    @property(cc.Float) bubbleRate: number = 1//子弹发射频率，默认间隔1秒发射\n\n    state: GameState = GameState.start\n    totalEnemy: number = 0\n    scoreNum: number = 0\n    \n    bubbleTimeBlock = function () {\n        this.bubbleGroup.createBullet()\n    }\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n         this.timer()\n    }\n\n    timer() {\n        this.schedule(this.bubbleTimeBlock, this.bubbleRate)\n    }\n\n    untimer() {\n        this.unschedule(this.bubbleTimeBlock)\n    }\n\n    updateScore() {\n        this.scoreNum += 1\n        this.scoreLabel.string = this.scoreNum.toString()\n    }\n\n    switchBulletAction(event: Event, cusEvn: number) {\n\n        this.bubbleGroup.bulletType = cusEvn\n        cc.log('~~~~~~~~~~~~~~~~~~')\n        cc.log(cusEvn)\n    }\n\n    pregameOver() {\n        this.state = GameState.over\n        this.untimer()\n        this.saveScore()\n    }\n\n    gameOver() {\n        cc.log('~~~~~~~~~~~~~~~~~~游戏结束')\n        cc.director.loadScene('endScene');\n    }\n\n    saveScore() {\n        var sk = 'score_0'\n        var idx = 0\n\n        let cds = cc.sys.localStorage.getItem('currentScore')\n        if (cds != null) {\n            let cd = JSON.parse(cds)\n            idx = cd.idx + 1\n            sk = 'score_' + idx\n\n            cc.log(cd == null, cd.idx)\n        }\n\n\n        var sd = {\n            'idx' : idx,\n            'score' : this.scoreNum,\n            'ctime' : this.format( new Date(), 'yyyy-MM-dd hh:mm:ss')\n        }\n        let ss  = JSON.stringify(sd)\n        cc.sys.localStorage.setItem('currentScore', ss)\n        cc.sys.localStorage.setItem(sk, ss)\n\n        cc.log(sk, sd.idx, sd.score, sd.ctime)\n    }\n\n    format(time: Date,fmt: string) { //author: meizz \n        var o = {\n            \"M+\": time.getMonth() + 1, //月份 \n            \"d+\": time.getDate(), //日 \n            \"h+\": time.getHours(), //小时 \n            \"m+\": time.getMinutes(), //分 \n            \"s+\": time.getSeconds(), //秒 \n            \"q+\": Math.floor((time.getMonth() + 3) / 3), //季度 \n            \"S\": time.getMilliseconds() //毫秒 \n        };\n        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (time.getFullYear() + \"\").substr(4 - RegExp.$1.length));\n        for (var k in o)\n        if (new RegExp(\"(\" + k + \")\").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\n        return fmt;\n    }\n}\n"]}