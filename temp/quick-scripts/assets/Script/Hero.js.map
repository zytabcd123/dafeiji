{"version":3,"sources":["Hero.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+BAA0B;AAE1B,oBAAoB;AACpB,kFAAkF;AAClF,yFAAyF;AACzF,mBAAmB;AACnB,4FAA4F;AAC5F,mGAAmG;AACnG,8BAA8B;AAC9B,4FAA4F;AAC5F,mGAAmG;AAE7F,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAyB,CAAC;AAG1C;IAAkC,wBAAY;IAD9C;QAAA,qEA4EC;QAzE2B,eAAS,GAAiB,IAAI,CAAA;QACtC,QAAE,GAAS,IAAI,CAAA;QAC/B,YAAM,GAAY,KAAK,CAAA;;IAuE3B,CAAC;IAtEG,wBAAwB;IAExB,qBAAM,GAAN;QACI,EAAE,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAA;QACxB,EAAE,CAAC,QAAQ,CAAC,mBAAmB,EAAE,CAAC,OAAO,GAAG,IAAI,CAAC;QACjD,IAAI,CAAC,MAAM,EAAE,CAAC;IAClB,CAAC;IAED,oBAAK,GAAL;IAEA,CAAC;IAED,iBAAiB;IAEjB,QAAQ;IACR,qBAAM,GAAN;QACI,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;IACnD,CAAC;IACD,QAAQ;IACR,sBAAO,GAAP;QACK,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;IACrD,CAAC;IACD,IAAI;IACJ,uBAAQ,GAAR,UAAS,KAAK;QACV,IAAI,SAAS,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;QACpC,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC;QAChE,UAAU;QACV,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,CAAA;QACpC,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC;QACjB,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAC,CAAC,CAAA;QACrC,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC;QACjB,IAAI,QAAQ,CAAC,CAAC,GAAE,IAAI,EAAC;YACjB,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC;SACrB;QACD,IAAI,QAAQ,CAAC,CAAC,GAAC,IAAI,EAAC;YAChB,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC;SACrB;QACD,IAAI,QAAQ,CAAC,CAAC,GAAE,IAAI,EAAC;YACjB,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC;SACrB;QACD,IAAI,QAAQ,CAAC,CAAC,GAAE,IAAI,EAAC;YACjB,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC;SACrB;QACD,uCAAuC;QACvC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;IACpC,CAAC;IAED,+BAAgB,GAAhB,UAAkB,KAAkB,EAAE,IAAiB;QACnD,IAAI,IAAI,CAAC,MAAM,EAAE;YAAC,OAAM;SAAC;QAEzB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;QAClB,IAAI,CAAC,cAAc,EAAE,CAAA;QACrB,IAAI,CAAC,EAAE,CAAC,WAAW,EAAE,CAAA;IACzB,CAAC;IAED,6BAAc,GAAd;QACI,IAAI,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAA;QACvC,CAAC,CAAC,YAAY,CAAC,iBAAiB,CAAC,CAAA;QACjC,CAAC,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,CAAA;QAEnD,EAAE,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,EAAE,KAAK,CAAC,CAAA;IACpD,CAAC;IAED,qCAAsB,GAAtB;QACI,+BAA+B;QAC/B,iBAAiB;QACjB,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,CAAA;QAClB,IAAI,CAAC,OAAO,EAAE,CAAA;IAClB,CAAC;IAvEuB;QAAvB,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;2CAA+B;IACtC;QAAf,QAAQ,CAAC,cAAI,CAAC;oCAAgB;IAHd,IAAI;QADxB,OAAO;OACa,IAAI,CA2ExB;IAAD,WAAC;CA3ED,AA2EC,CA3EiC,EAAE,CAAC,SAAS,GA2E7C;kBA3EoB,IAAI","file":"","sourceRoot":"../../../../assets/Script","sourcesContent":["import Game from \"./Game\";\n\n// Learn TypeScript:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Hero extends cc.Component {\n\n    @property(cc.AudioClip) diedAudio: cc.Texture2D = null\n    @property(Game) gm: Game = null\n    isDeid: boolean = false\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        cc.log('~~~~~~~~~~英雄加载')\n        cc.director.getCollisionManager().enabled = true;\n        this.onDrag();\n    }\n\n    start () {\n\n    }\n\n    // update (dt) {}\n\n    //添加拖动监听\n    onDrag(){\n        this.node.on('touchmove', this.dragMove, this);\n    }\n    //去掉拖动监听\n    offDrag(){ \n         this.node.off('touchmove', this.dragMove, this);\n    }\n    //拖动\n    dragMove(event){ \n        var locationv = event.getLocation();\n        var location = this.node.parent.convertToNodeSpaceAR(locationv);\n        //飞机不移出屏幕 \n        var minX = -this.node.parent.width/2\n        var maxX = -minX;\n        var minY = -this.node.parent.height/2\n        var maxY = -minY;\n        if (location.x< minX){\n            location.x = minX;\n        }\n        if (location.x>maxX){\n            location.x = maxX;\n        }\n        if (location.y< minY){\n            location.y = minY;\n        }\n        if (location.y> maxY){\n            location.y = maxY;\n        }\n        // cc.log('飞机', location.x, location.y)\n        this.node.setPosition(location);\n    }\n\n    onCollisionEnter (other: cc.Collider, self: cc.Collider) {\n        if (this.isDeid) {return}\n\n        this.isDeid = true\n        this.heroDeidEffect()\n        this.gm.pregameOver()\n    }\n\n    heroDeidEffect () {\n        var a = this.getComponent(cc.Animation)\n        a.playAdditive('hero_blowup_ani')\n        a.on('finished', this.heroDeidEffectFinished, this)\n\n        cc.audioEngine.playEffect(this.diedAudio, false)\n    }\n    \n    heroDeidEffectFinished() {\n        // this.node.removeFromParent()\n        // this.destroy()\n        this.gm.gameOver()\n        this.offDrag()\n    }\n\n}\n"]}